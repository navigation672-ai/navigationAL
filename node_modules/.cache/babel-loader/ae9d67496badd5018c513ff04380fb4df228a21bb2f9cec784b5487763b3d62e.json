{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useCallback, useEffect, useRef, useState } from 'react';\nconst SESSION_KEY = 'app_session';\nconst SESSION_TTL = 30 * 60 * 1000; // 30 minutes in ms\n\nfunction getStoredSession() {\n  try {\n    const raw = localStorage.getItem(SESSION_KEY);\n    if (!raw) return null;\n    const obj = JSON.parse(raw);\n    if (!obj || typeof obj.sessionStart !== 'number') return null;\n    return obj;\n  } catch (e) {\n    return null;\n  }\n}\nexport default function useSession() {\n  _s();\n  const [isSessionActive, setIsSessionActive] = useState(false);\n  const [isExpired, setIsExpired] = useState(false);\n  const [remainingTime, setRemainingTime] = useState(0);\n  const timeoutRef = useRef(null);\n  const intervalRef = useRef(null);\n  const clearTimeoutRef = () => {\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n      timeoutRef.current = null;\n    }\n  };\n  const clearIntervalRef = () => {\n    if (intervalRef.current) {\n      clearInterval(intervalRef.current);\n      intervalRef.current = null;\n    }\n  };\n  const expireNow = useCallback(() => {\n    localStorage.removeItem(SESSION_KEY);\n    clearTimeoutRef();\n    clearIntervalRef();\n    setIsSessionActive(false);\n    setIsExpired(true);\n    setRemainingTime(0);\n  }, []);\n  const startSession = useCallback(() => {\n    const session = {\n      sessionStart: Date.now()\n    };\n    localStorage.setItem(SESSION_KEY, JSON.stringify(session));\n\n    // (re)initialize state and timers\n    setIsSessionActive(true);\n    setIsExpired(false);\n    setRemainingTime(SESSION_TTL);\n    clearTimeoutRef();\n    clearIntervalRef();\n    timeoutRef.current = setTimeout(() => {\n      expireNow();\n    }, SESSION_TTL);\n\n    // update remaining time every second for UI (optional, kept light)\n    intervalRef.current = setInterval(() => {\n      const s = getStoredSession();\n      if (!s) {\n        setRemainingTime(0);\n        clearIntervalRef();\n        return;\n      }\n      const rem = Math.max(0, SESSION_TTL - (Date.now() - s.sessionStart));\n      setRemainingTime(rem);\n    }, 1000);\n  }, [expireNow]);\n  const logout = useCallback(() => {\n    clearTimeoutRef();\n    clearIntervalRef();\n    localStorage.removeItem(SESSION_KEY);\n    setIsSessionActive(false);\n    setIsExpired(false);\n    setRemainingTime(0);\n  }, []);\n  useEffect(() => {\n    const sess = getStoredSession();\n    if (!sess) {\n      // No session found => create one now (requirement 2)\n      startSession();\n      return;\n    }\n    const elapsed = Date.now() - sess.sessionStart;\n    if (elapsed >= SESSION_TTL) {\n      // expired on load\n      expireNow();\n      return;\n    }\n\n    // session still valid\n    const remaining = SESSION_TTL - elapsed;\n    setIsSessionActive(true);\n    setIsExpired(false);\n    setRemainingTime(remaining);\n    clearTimeoutRef();\n    clearIntervalRef();\n    timeoutRef.current = setTimeout(() => {\n      expireNow();\n    }, remaining);\n    intervalRef.current = setInterval(() => {\n      const s = getStoredSession();\n      if (!s) {\n        setRemainingTime(0);\n        clearIntervalRef();\n        return;\n      }\n      const rem = Math.max(0, SESSION_TTL - (Date.now() - s.sessionStart));\n      setRemainingTime(rem);\n    }, 1000);\n    return () => {\n      clearTimeoutRef();\n      clearIntervalRef();\n    };\n  }, [startSession, expireNow]);\n  useEffect(() => {\n    return () => {\n      clearTimeoutRef();\n      clearIntervalRef();\n    };\n  }, []);\n  return {\n    isSessionActive,\n    isExpired,\n    remainingTime,\n    startSession,\n    logout\n  };\n}\n_s(useSession, \"ruKX1x6WcfE+nP4O0K9bPMopipw=\");","map":{"version":3,"names":["useCallback","useEffect","useRef","useState","SESSION_KEY","SESSION_TTL","getStoredSession","raw","localStorage","getItem","obj","JSON","parse","sessionStart","e","useSession","_s","isSessionActive","setIsSessionActive","isExpired","setIsExpired","remainingTime","setRemainingTime","timeoutRef","intervalRef","clearTimeoutRef","current","clearTimeout","clearIntervalRef","clearInterval","expireNow","removeItem","startSession","session","Date","now","setItem","stringify","setTimeout","setInterval","s","rem","Math","max","logout","sess","elapsed","remaining"],"sources":["D:/ashokLeylandNav-main/src/hooks/useSession.js"],"sourcesContent":["import { useCallback, useEffect, useRef, useState } from 'react';\r\n\r\nconst SESSION_KEY = 'app_session';\r\nconst SESSION_TTL = 30 * 60 * 1000; // 30 minutes in ms\r\n\r\nfunction getStoredSession() {\r\n    try {\r\n        const raw = localStorage.getItem(SESSION_KEY);\r\n        if (!raw) return null;\r\n        const obj = JSON.parse(raw);\r\n        if (!obj || typeof obj.sessionStart !== 'number') return null;\r\n        return obj;\r\n    } catch (e) {\r\n        return null;\r\n    }\r\n}\r\n\r\nexport default function useSession() {\r\n    const [isSessionActive, setIsSessionActive] = useState(false);\r\n    const [isExpired, setIsExpired] = useState(false);\r\n    const [remainingTime, setRemainingTime] = useState(0);\r\n    const timeoutRef = useRef(null);\r\n    const intervalRef = useRef(null);\r\n\r\n    const clearTimeoutRef = () => {\r\n        if (timeoutRef.current) {\r\n            clearTimeout(timeoutRef.current);\r\n            timeoutRef.current = null;\r\n        }\r\n    };\r\n\r\n    const clearIntervalRef = () => {\r\n        if (intervalRef.current) {\r\n            clearInterval(intervalRef.current);\r\n            intervalRef.current = null;\r\n        }\r\n    };\r\n\r\n    const expireNow = useCallback(() => {\r\n        localStorage.removeItem(SESSION_KEY);\r\n        clearTimeoutRef();\r\n        clearIntervalRef();\r\n        setIsSessionActive(false);\r\n        setIsExpired(true);\r\n        setRemainingTime(0);\r\n    }, []);\r\n\r\n    const startSession = useCallback(() => {\r\n        const session = { sessionStart: Date.now() };\r\n        localStorage.setItem(SESSION_KEY, JSON.stringify(session));\r\n\r\n        // (re)initialize state and timers\r\n        setIsSessionActive(true);\r\n        setIsExpired(false);\r\n        setRemainingTime(SESSION_TTL);\r\n\r\n        clearTimeoutRef();\r\n        clearIntervalRef();\r\n\r\n        timeoutRef.current = setTimeout(() => {\r\n            expireNow();\r\n        }, SESSION_TTL);\r\n\r\n        // update remaining time every second for UI (optional, kept light)\r\n        intervalRef.current = setInterval(() => {\r\n            const s = getStoredSession();\r\n            if (!s) {\r\n                setRemainingTime(0);\r\n                clearIntervalRef();\r\n                return;\r\n            }\r\n            const rem = Math.max(0, SESSION_TTL - (Date.now() - s.sessionStart));\r\n            setRemainingTime(rem);\r\n        }, 1000);\r\n    }, [expireNow]);\r\n\r\n    const logout = useCallback(() => {\r\n        clearTimeoutRef();\r\n        clearIntervalRef();\r\n        localStorage.removeItem(SESSION_KEY);\r\n        setIsSessionActive(false);\r\n        setIsExpired(false);\r\n        setRemainingTime(0);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const sess = getStoredSession();\r\n        if (!sess) {\r\n            // No session found => create one now (requirement 2)\r\n            startSession();\r\n            return;\r\n        }\r\n\r\n        const elapsed = Date.now() - sess.sessionStart;\r\n        if (elapsed >= SESSION_TTL) {\r\n            // expired on load\r\n            expireNow();\r\n            return;\r\n        }\r\n\r\n        // session still valid\r\n        const remaining = SESSION_TTL - elapsed;\r\n        setIsSessionActive(true);\r\n        setIsExpired(false);\r\n        setRemainingTime(remaining);\r\n\r\n        clearTimeoutRef();\r\n        clearIntervalRef();\r\n\r\n        timeoutRef.current = setTimeout(() => {\r\n            expireNow();\r\n        }, remaining);\r\n\r\n        intervalRef.current = setInterval(() => {\r\n            const s = getStoredSession();\r\n            if (!s) {\r\n                setRemainingTime(0);\r\n                clearIntervalRef();\r\n                return;\r\n            }\r\n            const rem = Math.max(0, SESSION_TTL - (Date.now() - s.sessionStart));\r\n            setRemainingTime(rem);\r\n        }, 1000);\r\n\r\n        return () => {\r\n            clearTimeoutRef();\r\n            clearIntervalRef();\r\n        };\r\n    }, [startSession, expireNow]);\r\n\r\n    useEffect(() => {\r\n        return () => {\r\n            clearTimeoutRef();\r\n            clearIntervalRef();\r\n        };\r\n    }, []);\r\n\r\n    return {\r\n        isSessionActive,\r\n        isExpired,\r\n        remainingTime,\r\n        startSession,\r\n        logout\r\n    };\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
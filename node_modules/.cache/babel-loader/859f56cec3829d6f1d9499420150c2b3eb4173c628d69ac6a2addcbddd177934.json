{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useCallback, useEffect, useRef, useState } from 'react';\nconst SESSION_KEY = 'app_session';\nconst SESSION_TTL = 30 * 60 * 1000; // 30 minutes\n\nfunction getStoredSession() {\n  try {\n    const raw = localStorage.getItem(SESSION_KEY);\n    if (!raw) return null;\n    const obj = JSON.parse(raw);\n    if (!obj || typeof obj.sessionStart !== 'number') return null;\n    return obj;\n  } catch {\n    return null;\n  }\n}\nexport default function useSession() {\n  _s();\n  const [isSessionActive, setIsSessionActive] = useState(false);\n  const [isExpired, setIsExpired] = useState(false);\n  const [remainingTime, setRemainingTime] = useState(0);\n  const timeoutRef = useRef(null);\n  const intervalRef = useRef(null);\n  const clearTimers = () => {\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current);\n      timeoutRef.current = null;\n    }\n    if (intervalRef.current) {\n      clearInterval(intervalRef.current);\n      intervalRef.current = null;\n    }\n  };\n  const expireNow = useCallback(() => {\n    localStorage.removeItem(SESSION_KEY);\n    clearTimers();\n    setIsSessionActive(false);\n    setIsExpired(true);\n    setRemainingTime(0);\n  }, []);\n  const startSession = useCallback(() => {\n    const session = {\n      sessionStart: Date.now()\n    };\n    localStorage.setItem(SESSION_KEY, JSON.stringify(session));\n    setIsSessionActive(true);\n    setIsExpired(false);\n    setRemainingTime(SESSION_TTL);\n    clearTimers();\n    timeoutRef.current = setTimeout(expireNow, SESSION_TTL);\n    intervalRef.current = setInterval(() => {\n      const s = getStoredSession();\n      if (!s) return expireNow();\n      const rem = Math.max(0, SESSION_TTL - (Date.now() - s.sessionStart));\n      setRemainingTime(rem);\n    }, 1000);\n  }, [expireNow]);\n  const logout = useCallback(() => {\n    localStorage.removeItem(SESSION_KEY);\n    clearTimers();\n    setIsSessionActive(false);\n    setIsExpired(false);\n    setRemainingTime(0);\n  }, []);\n  useEffect(() => {\n    const sess = getStoredSession();\n    if (!sess) {\n      startSession();\n      return;\n    }\n    const elapsed = Date.now() - sess.sessionStart;\n    if (elapsed >= SESSION_TTL) {\n      expireNow();\n      return;\n    }\n    const remaining = SESSION_TTL - elapsed;\n    setIsSessionActive(true);\n    setIsExpired(false);\n    setRemainingTime(remaining);\n    clearTimers();\n    timeoutRef.current = setTimeout(expireNow, remaining);\n    intervalRef.current = setInterval(() => {\n      const s = getStoredSession();\n      if (!s) return expireNow();\n      const rem = Math.max(0, SESSION_TTL - (Date.now() - s.sessionStart));\n      setRemainingTime(rem);\n    }, 1000);\n    return clearTimers;\n  }, [startSession, expireNow]);\n  return {\n    isSessionActive,\n    isExpired,\n    remainingTime,\n    startSession,\n    logout\n  };\n}\n_s(useSession, \"mmofEMKR6q69pM1322w9thFiSdc=\");","map":{"version":3,"names":["useCallback","useEffect","useRef","useState","SESSION_KEY","SESSION_TTL","getStoredSession","raw","localStorage","getItem","obj","JSON","parse","sessionStart","useSession","_s","isSessionActive","setIsSessionActive","isExpired","setIsExpired","remainingTime","setRemainingTime","timeoutRef","intervalRef","clearTimers","current","clearTimeout","clearInterval","expireNow","removeItem","startSession","session","Date","now","setItem","stringify","setTimeout","setInterval","s","rem","Math","max","logout","sess","elapsed","remaining"],"sources":["D:/ashokLeylandNav-main/src/hooks/useSession.js"],"sourcesContent":["import { useCallback, useEffect, useRef, useState } from 'react';\r\n\r\nconst SESSION_KEY = 'app_session';\r\nconst SESSION_TTL = 30 * 60 * 1000; // 30 minutes\r\n\r\nfunction getStoredSession() {\r\n  try {\r\n    const raw = localStorage.getItem(SESSION_KEY);\r\n    if (!raw) return null;\r\n    const obj = JSON.parse(raw);\r\n    if (!obj || typeof obj.sessionStart !== 'number') return null;\r\n    return obj;\r\n  } catch {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport default function useSession() {\r\n  const [isSessionActive, setIsSessionActive] = useState(false);\r\n  const [isExpired, setIsExpired] = useState(false);\r\n  const [remainingTime, setRemainingTime] = useState(0);\r\n\r\n  const timeoutRef = useRef(null);\r\n  const intervalRef = useRef(null);\r\n\r\n  const clearTimers = () => {\r\n    if (timeoutRef.current) {\r\n      clearTimeout(timeoutRef.current);\r\n      timeoutRef.current = null;\r\n    }\r\n    if (intervalRef.current) {\r\n      clearInterval(intervalRef.current);\r\n      intervalRef.current = null;\r\n    }\r\n  };\r\n\r\n  const expireNow = useCallback(() => {\r\n    localStorage.removeItem(SESSION_KEY);\r\n    clearTimers();\r\n    setIsSessionActive(false);\r\n    setIsExpired(true);\r\n    setRemainingTime(0);\r\n  }, []);\r\n\r\n  const startSession = useCallback(() => {\r\n    const session = { sessionStart: Date.now() };\r\n    localStorage.setItem(SESSION_KEY, JSON.stringify(session));\r\n\r\n    setIsSessionActive(true);\r\n    setIsExpired(false);\r\n    setRemainingTime(SESSION_TTL);\r\n\r\n    clearTimers();\r\n\r\n    timeoutRef.current = setTimeout(expireNow, SESSION_TTL);\r\n\r\n    intervalRef.current = setInterval(() => {\r\n      const s = getStoredSession();\r\n      if (!s) return expireNow();\r\n\r\n      const rem = Math.max(0, SESSION_TTL - (Date.now() - s.sessionStart));\r\n      setRemainingTime(rem);\r\n    }, 1000);\r\n  }, [expireNow]);\r\n\r\n  const logout = useCallback(() => {\r\n    localStorage.removeItem(SESSION_KEY);\r\n    clearTimers();\r\n    setIsSessionActive(false);\r\n    setIsExpired(false);\r\n    setRemainingTime(0);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const sess = getStoredSession();\r\n\r\n    if (!sess) {\r\n      startSession();\r\n      return;\r\n    }\r\n\r\n    const elapsed = Date.now() - sess.sessionStart;\r\n    if (elapsed >= SESSION_TTL) {\r\n      expireNow();\r\n      return;\r\n    }\r\n\r\n    const remaining = SESSION_TTL - elapsed;\r\n    setIsSessionActive(true);\r\n    setIsExpired(false);\r\n    setRemainingTime(remaining);\r\n\r\n    clearTimers();\r\n\r\n    timeoutRef.current = setTimeout(expireNow, remaining);\r\n\r\n    intervalRef.current = setInterval(() => {\r\n      const s = getStoredSession();\r\n      if (!s) return expireNow();\r\n\r\n      const rem = Math.max(0, SESSION_TTL - (Date.now() - s.sessionStart));\r\n      setRemainingTime(rem);\r\n    }, 1000);\r\n\r\n    return clearTimers;\r\n  }, [startSession, expireNow]);\r\n\r\n  return {\r\n    isSessionActive,\r\n    isExpired,\r\n    remainingTime,\r\n    startSession,\r\n    logout\r\n  };\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}